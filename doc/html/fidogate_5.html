<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from ../fidogate.texi on 28 January 2000 -->

<TITLE>FIDOGATE  - Basic Configuration</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="fidogate_1.html">first</A>, <A HREF="fidogate_4.html">previous</A>, <A HREF="fidogate_6.html">next</A>, <A HREF="fidogate_7.html">last</A> section, <A HREF="fidogate_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC79" HREF="fidogate_toc.html#TOC79">Basic Configuration</A></H1>

<P>
<A NAME="IDX95"></A>


<P>
There seems to be some confusion about the basic configuration of the
mail/news system, the gateway, and the tosser, so I added this
chapter. Hopefully this will help ...



<UL>
<LI><A HREF="fidogate_5.html#SEC80">Sendmail</A>: Sendmail configuration
<LI><A HREF="fidogate_5.html#SEC81">Example Point</A>: Example point configuration
<LI><A HREF="fidogate_5.html#SEC82">Example Point 2</A>: Example configuration with 2 point addresses
<LI><A HREF="fidogate_5.html#SEC83">Example Node</A>: Example leaf node configuration
</UL>



<H2><A NAME="SEC80" HREF="fidogate_toc.html#TOC80">Sendmail Configuration</A></H2>
<P>
<A NAME="IDX96"></A>
<A NAME="IDX97"></A>


<P>
This section describes the FIDOGATE additions to the sendmail V8 m4
configuration.


<P>
FIDOGATE adds two new mailer files, <CODE>ftn.m4</CODE> and <CODE>ffx.m4</CODE>. Use
<CODE>MAILER(ftn)</CODE> and/or <CODE>Mailer(ffx)</CODE> to include these mailer
definitions. (See the comment above for what ffx is good for. Most
likely you won't need it.)


<P>
Please note that the new FIDOGATE mailers are based on the SMTP mailer
sender/recipient rewrite rules, so including <CODE>MAILER(smtp)</CODE> is
mandatory!


<P>
FIDOGATE ftn mailers (using the <CODE>ftnmail</CODE> wrapper for
<CODE>rfc2ftn</CODE>):


<DL COMPACT>

<DT><CODE>ftn</CODE>
<DD>
Mailer for sending to systems registered in the <CODE>hosts</CODE> config
file. <CODE>ftn</CODE> will bounce mails if the receiving host is not
registered or marked as down.

<DT><CODE>ftni</CODE>
<DD>
Mailer for sending to a typical p.f.n.z domain,
e.g. <CODE>.fidonet.org</CODE>. <CODE>ftni</CODE> will send the mail to any system,
regardless of the registration in <CODE>hosts</CODE>.

<DT><CODE>ftna</CODE>
<DD>
Like <CODE>ftni</CODE>, but the <CODE>ftna</CODE> mailer also sets the address and
uplink of the gateway to the relay host passed to this mailer.

<DT><CODE>ftno</CODE>
<DD>
Like <CODE>ftna</CODE>. In addition, this mailer sets the directory for
packets created by <CODE>rfc2ftn</CODE> to SPOOLDIR/outpkt/<I>relayhost</I>.

</DL>

<P>
FIDOGATE ffx mailer (using the <CODE>ffxmail</CODE> utitility):


<DL COMPACT>

<DT><CODE>ffx</CODE>
<DD>
Mailer for sending via the FIDOGATE ffx sub-system.

</DL>



<H2><A NAME="SEC81" HREF="fidogate_toc.html#TOC81">Example Point Configuration</A></H2>
<P>
<A NAME="IDX98"></A>
<A NAME="IDX99"></A>
<A NAME="IDX100"></A>


<P>
<B>Please note that this point configuration uses the FIDOGATE
tosser. Thus, it's different from the point configuration described in
Roland Rosenfeld's old Point HOWTO!!! The Point HOWTO configuration will 
definitely NOT work with FIDOGATE version 4!!!</B>


<P>
Actually, this point configuration is very similar to the node
configuration described in the next section.


<P>
Let's assume the following addresses:


<P>
Fido point address 2:2499/999.9


<P>
Boss node (NetMail and EchoMail) 2:2499/999


<P>
Address configuration <CODE>fidogate.conf</CODE> (gateway and point address
are the same!), gateway configuration <CODE>EchoMail4D</CODE> is stricly
reqired:



<PRE>
...
Address 2:2499/999.9
...
EchoMail4D
...
</PRE>

<P>
Routing configuration <CODE>routing</CODE>: mail for the local address on
hold, everything else is send to the boss node.



<PRE>
NetMail
route    hold   2:2499/999.9
route    normal 2:2499/999 1:* 2:* 3:* 4:* 5:* 6:*

EchoMail
sendmove hold   2:2499/999.9
sendmove normal *
</PRE>

<P>
Packer configuration <CODE>packing</CODE>: no packing (noarc, this is very
important) for own address, <CODE>zip</CODE> is the default archiver for
everything else.



<PRE>
arc  zip    "/usr/bin/zip -9gkjq %s %s"

pack noarc  2:2499/999.9
pack zip    *
</PRE>

<P>
Next, the EchoMail areas must be listed in the <CODE>areas.bbs</CODE> file. Do
<I>not</I> put your point address into <CODE>areas.bbs</CODE>! Example with two
areas (the directory <CODE>X</CODE> is not used for EchoMail areas), which
must be non-passthrough:



<PRE>
Example Point!User Name
X LINUX.GER 2:2499/999
X UNIX.GER  2:2499/999
</PRE>

<P>
In the gateway configuration, these areas must be listed in the
<CODE>areas</CODE> config file:



<PRE>
LINUX.GER fido.ger.linux -8
UNIX.GER  fido.ger.unix  -8
</PRE>

<P>
The example configuration files for this configuration can be found in
<CODE>examples/point/</CODE>. See also <CODE>scripts/run/runpoll</CODE> for a
suitable poll script, which does everything necessary for a FIDOGATE
point.




<H2><A NAME="SEC82" HREF="fidogate_toc.html#TOC82">Example Configuration with 2 Point Addresses</A></H2>
<P>
<A NAME="IDX101"></A>
<A NAME="IDX102"></A>
<A NAME="IDX103"></A>


<P>
This section describes a point setup with 2 different point addresses
and 2 different boss nodes. Thanks to Stephan Zellerhoff
&#60;stephan@poi.westfalen.de&#62; for contributing some stuff.


<P>
Let's assume the following addresses:


<P>
Primary point address 2:2499/999.9, boss node 2:2499/999


<P>
Secondary point address 2:2498/888.8, boss node 2:2498/888


<P>
Setup with FIDOGATE:


<DL COMPACT>

<DT><B>Addresses</B>
<DD>
Put the following address statements in <CODE>fidogate.conf</CODE>

<PRE>
Address 2:2499/999.9
Address 2:2498/888.8
</PRE>

Please note that the primary point address must be the <I>first</I> entry!

<DT><B>Sendmail</B>
<DD>
Use the sendmail <CODE>mailertable</CODE> feature and create the following
entries for routing Fidonet mail:

<PRE>
# Mail to 2:2498/*, secondary address
.n2498.z2.fidonet.org    ftna:p8.f888.n2498.z2.fidonet.org
# Everything else 2:*/*, primary address
.z2.fidonet.org          ftna:p9.f999.n2499.z2.fidonet.org
</PRE>

Please note that in this setup, the relay host specified with the
<CODE>ftna</CODE> mailer is your <I>own</I> address, not your boss node!!!

<DT><B>Areas</B>
<DD>
Areas send to the primary boss don't require anything special in the
<CODE>areas</CODE> config file, areas send to the secondary boss must have the
<CODE>-a 2:2498/888.8</CODE> option, e.g.

<PRE>
LINUX.GER    fido.ger.linux    -a 2:2498/888.8 -8
</PRE>

<DT><B>Areas.BBS</B>
<DD>
Likewise, areas send to the secondary boss must have the <CODE>-a
2:2498/888.8</CODE> option in <CODE>areas.bbs</CODE> and the secondary boss as the
uplink, e.g.

<PRE>
X LINUX.GER    -a 2:2498/888.8    2:2498/888
</PRE>

<DT><B>Routing</B>
<DD>
The netmail routing must be adapted to send mail to the secondary boss,
e.g. everything for net 2498:

<PRE>
NetMail
route    hold     2:2499/999.9
route    hold     2:2498/888.8

route    normal   2:2498/888 2:2498/*.*
route    normal   2:2499/999 2:*

EchoMail
sendmove hold     2:2499/999.9 2498/888.8
sendmove normal   *
</PRE>

<DT><B>Packing</B>
<DD>
Packer configuration <CODE>packing</CODE>: no packing (noarc, this is very
important) for all of our own addressess, <CODE>zip</CODE> is the default
archiver for everything else.


<PRE>
arc  zip    "/usr/bin/zip -9gkjq %s %s"

pack noarc  2:2499/999.9 2498/888.8
pack zip    *
</PRE>

</DL>

<P>
Otherwise see the standard point configuration with a single address.




<H2><A NAME="SEC83" HREF="fidogate_toc.html#TOC83">Example Leaf Node configuration</A></H2>
<P>
<A NAME="IDX104"></A>
<A NAME="IDX105"></A>
<A NAME="IDX106"></A>


<P>
Let's assume the following addresses:


<P>
Fido main address 2:2499/999


<P>
Uplink (NetMail and EchoMail) 2:2499/900


<P>
Gateway point address 2:2499/999.1


<P>
Two points, Max Mueller @ 2:2499/999.10, Sabine Meier @ 2:2499/999.11


<P>
Address configuration <CODE>fidogate.conf</CODE>:



<PRE>
Address     2:2499/999
GateAddress 2:2499/999.1
</PRE>

<P>
Routing configuration <CODE>routing</CODE>: NetMail for the two points will be
remapped to their point addresses, everything else to the gateway (where
you will be reading your mail). NetMail for all points is <CODE>send</CODE>
onto hold, everything else <CODE>route</CODE>d to your uplink. EchoMail is
alway put onto hold.



<PRE>
remap    2:2499/999.0 2:2499/999.10 "Max Mueller"
remap    2:2499/999.0 2:2499/999.11 "Sabine Meier"
remap    2:2499/999.0 2:2499/999.1  "*"

NetMail
send     hold   2:2499/999.*
route    normal 2:2499/900 1:* 2:* 3:* 4:* 5:* 6:*

EchoMail
sendmove hold   2:2499/999.*
sendmove normal *
</PRE>

<P>
Packer configuration <CODE>packing</CODE>: <CODE>noarc</CODE> packing for the
gateway address, <CODE>zip</CODE> is the default archiver for everything else.



<PRE>
arc      zip    "/usr/bin/zip -9gkjq %s %s"

pack     noarc  2:2499/999.1
pack     zip    *
</PRE>

<P>
Next, the EchoMail areas must be listed in the <CODE>areas.bbs</CODE> file. Do
<I>not</I> put your node address into <CODE>areas.bbs</CODE>! Example with two
areas, both subscribed by the gateway and your points (the directory
<CODE>X</CODE> is not used for EchoMail areas):



<PRE>
Your system name!sysop name
#X LINUX.GER 2:2499/900 999.1 .10 .11
#X UNIX.GER  2:2499/900 999.1 .11
</PRE>

<P>
<CODE>#</CODE> denotes a <I>passthrough</I> area, i.e. no packets for the own
address (2:2499/999) are created. All EchoMail will be send to the
gateway (.1).


<P>
In the gateway configuration, these areas must be listed in the
<CODE>areas</CODE> config file:



<PRE>
LINUX.GER fido.ger.linux -8
UNIX.GER  fido.ger.unix  -8
</PRE>

<P>
For regular processing, the following scripts should be run from cron
every 20 min or so:
<DL COMPACT>

<DT><CODE>rungate</CODE>
<DD>
Inbound gateway (Fido -&#62; Internet and FTN -&#62; FTN) processing

<DT><CODE>runin</CODE>
<DD>
Inbound tosser and ticker processing

<DT><CODE>runmail</CODE>
<DD>
Outbound gateway for mail (Internet -&#62; Fido) processing.

<DT><CODE>runnews</CODE>
<DD>
Outbound gateway for news (Internet -&#62; Fido) processing.

<DT><CODE>runout</CODE>
<DD>
Outbound packet processing (various sources).

</DL>

<P>
To use the areafix, the gateway and the mail system must be working. You
can then install suitable aliases in <CODE>/etc/aliases</CODE>:



<PRE>
# Areafix/Filefix - FIDOGATE ftnaf
areafix: "|/usr/lib/fidogate/ftnafmail"
areamgr: areafix
filefix: "|/usr/lib/fidogate/ftnafmail -F"
filemgr: filefix
</PRE>

<P>
That's it. I hope that this short chapter on basic configuration clarifies
some of the darker point of the FIDOGATE configuration. Anyway, please
help to improve the FIDOGATE documentation.


<P><HR><P>
Go to the <A HREF="fidogate_1.html">first</A>, <A HREF="fidogate_4.html">previous</A>, <A HREF="fidogate_6.html">next</A>, <A HREF="fidogate_7.html">last</A> section, <A HREF="fidogate_toc.html">table of contents</A>.
</BODY>
</HTML>
